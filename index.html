<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8" />
    <title>Grace çš„çƒ˜ç„™é£Ÿè­œ </title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        
        
        .z-50 {
            z-index: 50;
        }
    </style>
</head>

<body class="bg-purple-50">
    <div id="app" class="max-w-6xl mx-auto p-6">

        <header class="relative mb-6 rounded-lg overflow-hidden shadow-lg">
            <img src="images/header.jpg" alt="Grace Baking Header" class="w-full h-64 md:h-80 object-cover">
            <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center">
                <div class="text-center px-4">
                    <h1 class="text-4xl md:text-5xl font-bold text-white mb-3">Grace çš„çƒ˜ç„™é£Ÿè­œ </h1>
                    <p class="text-white text-sm md:text-lg">ä¸ä½¿ç”¨äººå·¥æ·»åŠ ç‰©ï¼Œåˆ†äº«æº«æš–æ‰‹ä½œç”œé»<br>å¾æ—¥å¸¸çƒ˜ç„™åˆ°å¹¸ç¦æ»‹å‘³</p>
                </div>
            </div>
        </header>

        <div class="flex flex-col sm:flex-row justify-between mb-6 gap-4">
            <div class="flex gap-2 flex-wrap">
                <button v-for="c in categoryButtons" :key="c.label" @click="selectedCategory = c.key" :class="buttonClass(c.key)" class="px-4 py-2 rounded shadow transition">
                    {{ c.label }} ({{ c.count }})
                </button>
            </div>
            <input v-model="searchText" type="text" placeholder="æœå°‹é£Ÿè­œåç¨±" class="p-2 rounded border w-full sm:w-64 shadow focus:ring-purple-500 focus:border-purple-500">
        </div>

        <div v-if="filteredRecipes.length > 0" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <div v-for="recipe in filteredRecipes" :key="recipe.id" class="bg-white p-4 rounded-xl shadow hover:shadow-xl transition">
                <img :src="recipe.image.src" :alt="recipe.image.alt" class="rounded-md mb-2 w-full h-40 object-cover">
                <h2 class="text-xl font-semibold text-purple-700">{{ recipe.name }}</h2>
                <p class="text-gray-700 text-sm mb-1 line-clamp-2">{{ recipe.description }}</p>
                <p class="text-sm text-gray-500 mb-2">åˆ†é¡ï¼š{{ categoryLabel[recipe.categoryKey] }}</p>

                <div class="flex gap-1 mb-2">
                    <span v-for="n in 5" :key="n" @click="rate(recipe, n)" class="cursor-pointer transition" :class="n <= recipe.rating ? 'text-yellow-400' : 'text-gray-300 hover:text-yellow-300'">â˜…</span>
                </div>

                <div class="flex justify-between items-center">
                    <button @click="selectRecipe(recipe)" class="bg-purple-500 text-white px-3 py-1 rounded hover:bg-purple-600 transition text-sm">æŸ¥çœ‹è©³ç´°</button>
                    <button @click="toggleFavorite(recipe)" title="åˆ‡æ›æ”¶è—ç‹€æ…‹">
                        <span v-if="recipe.favorite" class="text-red-500 text-2xl transition hover:scale-110">â™¥</span>
                        <span v-else class="text-gray-400 text-2xl transition hover:text-red-300">â™¡</span>
                    </button>
                </div>
            </div>
        </div>
        <div v-else class="text-center p-12 bg-white rounded-lg shadow-lg">
            <p class="text-xl text-gray-600">æ²’æœ‰æ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„é£Ÿè­œ ğŸ˜¢</p>
            <button @click="resetFilters" class="mt-4 text-purple-500 hover:underline">é»æ­¤æ¸…é™¤ç¯©é¸æ¢ä»¶</button>
        </div>

        <div v-if="selectedRecipe" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white p-6 rounded-xl shadow-2xl w-11/12 md:w-2/3 max-h-[90vh] overflow-y-auto">
                <img :src="selectedRecipe.image.src" :alt="selectedRecipe.image.alt" class="rounded-md mb-4 w-full h-60 object-cover">
                <h2 class="text-3xl font-bold mb-2 text-purple-800">{{ selectedRecipe.name }}</h2>
                <p class="text-gray-700 mb-4">{{ selectedRecipe.description }}</p>

                <div class="mb-4 p-3 bg-purple-50 rounded">
                    <label class="font-medium text-purple-700">èª¿æ•´ä»½é‡ï¼ˆå€æ•¸ï¼‰ï¼š</label>
                    <input type="number" v-model.number="portion" min="1" class="w-20 p-1 border rounded ml-2 text-center" @change="portion = Math.max(1, portion)">
                </div>

                <h3 class="font-semibold mb-1 text-lg border-b pb-1 text-purple-700">ææ–™ (x{{ portion }})</h3>
                <ul class="list-disc ml-6 mb-4 space-y-1">
                    <li v-for="item in adjustedIngredients(selectedRecipe)" :key="item">{{ item }}</li>
                </ul>

                <h3 class="font-semibold mb-1 text-lg border-b pb-1 text-purple-700">æ­¥é©Ÿ</h3>
                <ol class="list-decimal ml-6 mb-6 space-y-2">
                    <li v-for="step in selectedRecipe.steps" :key="step.order">{{ step.text }}</li>
                </ol>

                <div class="flex gap-3 justify-end pt-2 border-t">
                    <button @click="printRecipe(selectedRecipe)" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 transition">åˆ—å°é£Ÿè­œ</button>
                    <button @click="closeRecipe" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition">é—œé–‰</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        const {
            createApp,
            computed
        } = Vue;

        
        const rawRecipesData = [{
            id: 1,
            name: "å·§å…‹åŠ›è›‹ç³•",
            category: "è›‹ç³•",
            shortDesc: "æ¿ƒéƒå·§å…‹åŠ›é¢¨å‘³ï¼Œå…¥å£å³åŒ–",
            img: "images/01.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["å·§å…‹åŠ› 200g", "ä½ç­‹éºµç²‰ 150g", "ç³– 100g", "è›‹ 3é¡†", "å¥¶æ²¹ 50g"],
            steps: ["çƒ¤ç®±é ç†± 180åº¦", "å·§å…‹åŠ›éš”æ°´èåŒ–", "æ··åˆææ–™", "å€’å…¥æ¨¡å…·çƒ¤ 30 åˆ†é˜"]
        }, {
            id: 2,
            name: "æŠ¹èŒ¶é¤…ä¹¾",
            category: "é¤…ä¹¾",
            shortDesc: "æ¸…é¦™æŠ¹èŒ¶å‘³ï¼Œé…¥è„†å¯å£",
            img: "images/02.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 200g", "å¥¶æ²¹ 100g", "ç³– 80g", "æŠ¹èŒ¶ç²‰ 10g"],
            steps: ["å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥éºµç²‰æŠ¹èŒ¶ç²‰", "æ•´å½¢çƒ¤ 15 åˆ†é˜"]
        }, {
            id: 3,
            name: "æ³•åœ‹éºµåŒ…",
            category: "éºµåŒ…",
            shortDesc: "å¤–é…¥å…§è»Ÿï¼Œå‚³çµ±é¢¨å‘³",
            img: "images/03.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 300g", "æ°´ 180ml", "é…µæ¯ 5g", "é¹½ 5g"],
            steps: ["æ··åˆææ–™", "æ‰éºµ", "ç™¼é…µ 1 å°æ™‚", "çƒ¤ç®±çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 4,
            name: "å¥¶æ²¹æ³¡èŠ™",
            category: "è›‹ç³•",
            shortDesc: "å¤–è„†å…§è»Ÿï¼Œé¦™ç”œå¥¶æ²¹",
            img: "images/04.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 100g", "å¥¶æ²¹ 80g", "è›‹ 2é¡†", "ç‰›å¥¶ 100ml"],
            steps: ["å°‡å¥¶æ²¹ç‰›å¥¶ç…®ç†±", "åŠ å…¥éºµç²‰æ”ªæ‹Œ", "æ‰“å…¥è›‹æ¶²", "æ“ å…¥çƒ¤ç›¤çƒ¤ 20 åˆ†é˜"]
        }, {
            id: 5,
            name: "è‚‰æ¡‚æ²",
            category: "éºµåŒ…",
            shortDesc: "é¦™ç”œè‚‰æ¡‚å‘³ï¼Œè»Ÿå«©å¯å£",
            img: "images/05.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 250g", "ç³– 50g", "å¥¶æ²¹ 50g", "è‚‰æ¡‚ç²‰ 5g", "é…µæ¯ 5g"],
            steps: ["æ··åˆææ–™", "æ‰éºµç™¼é…µ 1 å°æ™‚", "æ²æˆå·ç‹€", "çƒ¤ç®±çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 6,
            name: "æª¸æª¬ç£…è›‹ç³•",
            category: "è›‹ç³•",
            shortDesc: "é…¸ç”œæ¸…æ–°ï¼Œé¬†è»Ÿå¯å£",
            img: "images/06.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 150g", "ç³– 120g", "è›‹ 3é¡†", "å¥¶æ²¹ 100g", "æª¸æª¬æ± 30ml"],
            steps: ["çƒ¤ç®±é ç†± 170åº¦", "å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰èˆ‡æª¸æª¬æ±", "çƒ¤ 40 åˆ†é˜"]
        }, {
            id: 7,
            name: "å·§å…‹åŠ›æ›²å¥‡",
            category: "é¤…ä¹¾",
            shortDesc: "æ¿ƒéƒå·§å…‹åŠ›å‘³ï¼Œå¤–è„†å…§è»Ÿ",
            img: "images/07.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 200g", "å¥¶æ²¹ 100g", "ç³– 80g", "å·§å…‹åŠ›è±† 100g", "è›‹ 1é¡†"],
            steps: ["å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰èˆ‡å·§å…‹åŠ›è±†", "çƒ¤ 15 åˆ†é˜"]
        }, {
            id: 8,
            name: "è‘¡è„ä¹¾éºµåŒ…",
            category: "éºµåŒ…",
            shortDesc: "é¬†è»Ÿå¸¶é¦™ç”œè‘¡è„ä¹¾",
            img: "images/08.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 300g", "ç³– 50g", "é…µæ¯ 5g", "å¥¶æ²¹ 50g", "è‘¡è„ä¹¾ 80g", "æ°´ 180ml"],
            steps: ["æ··åˆææ–™", "æ‰éºµç™¼é…µ 1 å°æ™‚", "æ•´å½¢åŠ å…¥è‘¡è„ä¹¾", "çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 9,
            name: "ç´…è±†è›‹ç³•",
            category: "è›‹ç³•",
            shortDesc: "ç¶¿å¯†è›‹ç³•èˆ‡ç”œç´…è±†",
            img: "images/09.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 150g", "ç³– 100g", "è›‹ 3é¡†", "å¥¶æ²¹ 80g", "ç´…è±†é¤¡ 100g"],
            steps: ["çƒ¤ç®±é ç†± 170åº¦", "å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰", "å€’å…¥ç´…è±†é¤¡çƒ¤ 35 åˆ†é˜"]
        }, {
            id: 10,
            name: "æä»é¤…ä¹¾",
            category: "é¤…ä¹¾",
            shortDesc: "é…¥è„†æä»é¦™",
            img: "images/10.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 200g", "å¥¶æ²¹ 100g", "ç³– 80g", "æä»ç²‰ 20g", "è›‹ 1é¡†"],
            steps: ["å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰èˆ‡æä»ç²‰", "çƒ¤ 15 åˆ†é˜"]
        }, {
            id: 11,
            name: "å¯å¯éºµåŒ…æ²",
            category: "éºµåŒ…",
            shortDesc: "å·§å…‹åŠ›é¦™æ°£æ¿ƒéƒçš„è»ŸéºµåŒ…",
            img: "images/11.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 300g", "ç³– 50g", "å¯å¯ç²‰ 20g", "å¥¶æ²¹ 50g", "é…µæ¯ 5g", "æ°´ 180ml"],
            steps: ["æ··åˆææ–™", "æ‰éºµç™¼é…µ 1 å°æ™‚", "æ•´å½¢", "çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 12,
            name: "è—è“ä¹³é…ªè›‹ç³•",
            category: "è›‹ç³•",
            shortDesc: "é…¸ç”œè—è“èˆ‡æ¿ƒéƒä¹³é…ª",
            img: "images/12.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["å¥¶æ²¹ä¹³é…ª 200g", "ç³– 80g", "è›‹ 3é¡†", "ä½ç­‹éºµç²‰ 100g", "è—è“ 100g"],
            steps: ["å¥¶æ²¹ä¹³é…ªæ‰“ç™¼", "åŠ å…¥ç³–å’Œè›‹", "æ‹Œå…¥éºµç²‰", "å€’å…¥è—è“çƒ¤ 40 åˆ†é˜"]
        }, {
            id: 13,
            name: "å·§å…‹åŠ›å¸ƒæœ—å°¼",
            category: "è›‹ç³•",
            shortDesc: "æ¿•æ½¤å·§å…‹åŠ›æ¿ƒéƒå¸ƒæœ—å°¼",
            img: "images/13.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["å·§å…‹åŠ› 200g", "å¥¶æ²¹ 100g", "ç³– 120g", "è›‹ 3é¡†", "ä½ç­‹éºµç²‰ 80g"],
            steps: ["çƒ¤ç®±é ç†± 180åº¦", "å·§å…‹åŠ›å¥¶æ²¹èåŒ–", "åŠ å…¥ç³–å’Œè›‹", "æ‹Œå…¥éºµç²‰", "çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 14,
            name: "æ¤°å­é¤…ä¹¾",
            category: "é¤…ä¹¾",
            shortDesc: "é¦™æ¿ƒæ¤°å­å‘³ï¼Œé…¥è„†å¯å£",
            img: "images/14.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 200g", "å¥¶æ²¹ 100g", "ç³– 80g", "æ¤°å­ç²‰ 30g", "è›‹ 1é¡†"],
            steps: ["å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰èˆ‡æ¤°å­ç²‰", "çƒ¤ 15 åˆ†é˜"]
        }, {
            id: 15,
            name: "å¥¶é¦™åå¸",
            category: "éºµåŒ…",
            shortDesc: "è»Ÿå«©å¥¶é¦™ï¼Œé©åˆæ—©é¤",
            img: "images/15.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 300g", "ç³– 40g", "å¥¶ç²‰ 20g", "å¥¶æ²¹ 30g", "é…µæ¯ 5g", "æ°´ 180ml"],
            steps: ["æ··åˆææ–™", "æ‰éºµç™¼é…µ 1 å°æ™‚", "æ•´å½¢", "çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 16,
            name: "æª¸æª¬å¡”",
            category: "è›‹ç³•",
            shortDesc: "é…¸ç”œæª¸æª¬é¦™æ°£æ¿ƒéƒ",
            img: "images/16.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["å¡”çš®ææ–™", "æª¸æª¬æ± 50ml", "ç³– 100g", "è›‹ 2é¡†", "å¥¶æ²¹ 50g"],
            steps: ["è£½ä½œå¡”çš®", "çƒ¤ 15 åˆ†é˜", "æ··åˆé¤¡æ–™", "å€’å…¥å¡”çš®çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 17,
            name: "å·§å…‹åŠ›ç¢ç‰‡é¤…ä¹¾",
            category: "é¤…ä¹¾",
            shortDesc: "æ¿ƒéƒå·§å…‹åŠ›ç¢ç‰‡é…¥è„†å£æ„Ÿ",
            img: "images/17.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 200g", "å¥¶æ²¹ 100g", "ç³– 80g", "å·§å…‹åŠ›ç¢ç‰‡ 100g", "è›‹ 1é¡†"],
            steps: ["å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰èˆ‡å·§å…‹åŠ›ç¢ç‰‡", "çƒ¤ 15 åˆ†é˜"]
        }, {
            id: 18,
            name: "æ ¸æ¡ƒéºµåŒ…",
            category: "éºµåŒ…",
            shortDesc: "è»ŸéºµåŒ…ä¸­å¸¶é¦™è„†æ ¸æ¡ƒ",
            img: "images/18.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 300g", "ç³– 40g", "å¥¶æ²¹ 30g", "é…µæ¯ 5g", "æ°´ 180ml", "æ ¸æ¡ƒ 50g"],
            steps: ["æ··åˆææ–™", "æ‰éºµç™¼é…µ", "åŠ å…¥æ ¸æ¡ƒæ•´å½¢", "çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 19,
            name: "è‰è“å¥¶æ²¹è›‹ç³•",
            category: "è›‹ç³•",
            shortDesc: "é¦™ç”œè‰è“æ­é…å¥¶æ²¹",
            img: "images/19.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 150g", "ç³– 100g", "è›‹ 3é¡†", "å¥¶æ²¹ 80g", "è‰è“ 100g"],
            steps: ["çƒ¤ç®±é ç†± 170åº¦", "å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰", "è£é£¾è‰è“"]
        }, {
            id: 20,
            name: "å·§å…‹åŠ›é¤…ä¹¾",
            category: "é¤…ä¹¾",
            shortDesc: "æ¿ƒéƒå·§å…‹åŠ›å£æ„Ÿ",
            img: "images/20.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 200g", "å¥¶æ²¹ 100g", "ç³– 80g", "å·§å…‹åŠ› 100g", "è›‹ 1é¡†"],
            steps: ["å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰å’Œå·§å…‹åŠ›", "çƒ¤ 15 åˆ†é˜"]
        }, {
            id: 21,
            name: "èœ‚èœœåå¸",
            category: "éºµåŒ…",
            shortDesc: "ç”œèœœèœ‚èœœé¢¨å‘³è»Ÿåå¸",
            img: "images/21.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 300g", "ç³– 40g", "å¥¶æ²¹ 30g", "é…µæ¯ 5g", "æ°´ 180ml", "èœ‚èœœ 30ml"],
            steps: ["æ··åˆææ–™", "æ‰éºµç™¼é…µ", "æ•´å½¢", "çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 22,
            name: "èŠ’æœä¹³é…ªè›‹ç³•",
            category: "è›‹ç³•",
            shortDesc: "èŠ’æœé¦™æ°£èˆ‡ä¹³é…ªæ¿ƒéƒå£æ„Ÿ",
            img: "images/22.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["å¥¶æ²¹ä¹³é…ª 200g", "ç³– 80g", "è›‹ 3é¡†", "èŠ’æœæ³¥ 100g", "ä½ç­‹éºµç²‰ 100g"],
            steps: ["å¥¶æ²¹ä¹³é…ªæ‰“ç™¼", "åŠ å…¥ç³–å’Œè›‹", "æ‹Œå…¥éºµç²‰å’ŒèŠ’æœæ³¥", "çƒ¤ 40 åˆ†é˜"]
        }, {
            id: 23,
            name: "æª¸æª¬é¤…ä¹¾",
            category: "é¤…ä¹¾",
            shortDesc: "æ¸…æ–°æª¸æª¬é¦™æ°£ï¼Œé…¥è„†å¯å£",
            img: "images/23.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 200g", "å¥¶æ²¹ 100g", "ç³– 80g", "æª¸æª¬çš® 5g", "è›‹ 1é¡†"],
            steps: ["å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰èˆ‡æª¸æª¬çš®", "çƒ¤ 15 åˆ†é˜"]
        }, {
            id: 24,
            name: "èµ·å¸éºµåŒ…",
            category: "éºµåŒ…",
            shortDesc: "é¦™æ¿ƒèµ·å¸é¢¨å‘³è»ŸéºµåŒ…",
            img: "images/24.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 300g", "ç³– 40g", "å¥¶æ²¹ 30g", "é…µæ¯ 5g", "æ°´ 180ml", "èµ·å¸ç‰‡ 50g"],
            steps: ["æ··åˆææ–™", "æ‰éºµç™¼é…µ", "æ•´å½¢åŠ å…¥èµ·å¸", "çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 25,
            name: "é¦™è•‰è›‹ç³•",
            category: "è›‹ç³•",
            shortDesc: "é¦™è•‰é¦™ç”œæ¿•æ½¤è›‹ç³•",
            img: "images/25.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 150g", "ç³– 100g", "è›‹ 3é¡†", "é¦™è•‰ 100g", "å¥¶æ²¹ 80g"],
            steps: ["çƒ¤ç®±é ç†± 170åº¦", "å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²å’Œé¦™è•‰æ³¥", "æ‹Œå…¥éºµç²‰", "çƒ¤ 4 0åˆ†é˜"]
        }, {
            id: 26,
            name: "æ¤°é¦™é¤…ä¹¾",
            category: "é¤…ä¹¾",
            shortDesc: "æ¿ƒéƒæ¤°é¦™ï¼Œé…¥è„†å¯å£",
            img: "images/26.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 200g", "å¥¶æ²¹ 100g", "ç³– 80g", "æ¤°å­ç²‰ 30g", "è›‹ 1é¡†"],
            steps: ["å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰èˆ‡æ¤°å­ç²‰", "çƒ¤ 15 åˆ†é˜"]
        }, {
            id: 27,
            name: "è‘¡è„ä¹¾åå¸",
            category: "éºµåŒ…",
            shortDesc: "é¦™è»Ÿåå¸æ­é…è‘¡è„ä¹¾",
            img: "images/27.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 300g", "ç³– 40g", "å¥¶æ²¹ 30g", "é…µæ¯ 5g", "æ°´ 180ml", "è‘¡è„ä¹¾ 50g"],
            steps: ["æ··åˆææ–™", "æ‰éºµç™¼é…µ", "æ•´å½¢åŠ å…¥è‘¡è„ä¹¾", "çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 28,
            name: "æŠ¹èŒ¶è›‹ç³•æ²",
            category: "è›‹ç³•",
            shortDesc: "æ¸…é¦™æŠ¹èŒ¶èˆ‡é¬†è»Ÿè›‹ç³•æ²",
            img: "images/28.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 150g", "ç³– 100g", "è›‹ 3é¡†", "æŠ¹èŒ¶ç²‰ 10g", "å¥¶æ²¹ 80g"],
            steps: ["çƒ¤ç®±é ç†± 170åº¦", "è›‹æ¶²æ‰“ç™¼", "åŠ å…¥ç³–å’ŒæŠ¹èŒ¶ç²‰", "çƒ¤ 20 åˆ†é˜", "æ²èµ·æˆè›‹ç³•å·"]
        }, {
            id: 29,
            name: "å·§å…‹åŠ›è±†é¤…ä¹¾",
            category: "é¤…ä¹¾",
            shortDesc: "å¤–è„†å…§è»Ÿå·§å…‹åŠ›è±†é¢¨å‘³",
            img: "images/29.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["ä½ç­‹éºµç²‰ 200g", "å¥¶æ²¹ 100g", "ç³– 80g", "å·§å…‹åŠ›è±† 100g", "è›‹ 1é¡†"],
            steps: ["å¥¶æ²¹ç³–æ‰“ç™¼", "åŠ å…¥è›‹æ¶²", "æ‹Œå…¥éºµç²‰èˆ‡å·§å…‹åŠ›è±†", "çƒ¤ 15 åˆ†é˜"]
        }, {
            id: 30,
            name: "è”“è¶Šè“éºµåŒ…",
            category: "éºµåŒ…",
            shortDesc: "é…¸ç”œè”“è¶Šè“è»ŸéºµåŒ…",
            img: "images/30.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["é«˜ç­‹éºµç²‰ 300g", "ç³– 40g", "å¥¶æ²¹ 30g", "é…µæ¯ 5g", "æ°´ 180ml", "è”“è¶Šè“ä¹¾ 50g"],
            steps: ["æ··åˆææ–™", "æ‰éºµç™¼é…µ", "æ•´å½¢åŠ å…¥è”“è¶Šè“", "çƒ¤ 25 åˆ†é˜"]
        }, {
            id: 31,
            name: "å¥¶é…ªè›‹ç³•",
            category: "è›‹ç³•",
            shortDesc: "æ»‘é †å¥¶é…ªè›‹ç³•ï¼Œå…¥å£å³åŒ–",
            img: "images/31.jpg", // æœ¬åœ°åœ–ç‰‡
            ingredients: ["å¥¶æ²¹ä¹³é…ª 200g", "ç³– 80g", "è›‹ 3é¡†", "é®®å¥¶æ²¹ 100ml", "å‰åˆ©ä¸ 5g"],
            steps: ["å¥¶æ²¹ä¹³é…ªæ‰“ç™¼", "åŠ å…¥ç³–å’Œè›‹", "æ‹Œå…¥é®®å¥¶æ²¹å’Œå‰åˆ©ä¸", "çƒ¤ 35 åˆ†é˜"]
        }, ];


        const CATEGORY_MAP = {
            è›‹ç³•: "cake",
            é¤…ä¹¾: "cookie",
            éºµåŒ…: "bread"
        };

    
        function parseIngredient(text) {
            //æ ¼å¼ï¼š"åç¨± æ•¸é‡å–®ä½"
            const match = text.match(/(.+?)\s(\d+)(g|ml|é¡†|å€‹)?$/);
            if (!match) return {
                name: text,
                amount: null,
                unit: ""
            };
            return {
                name: match[1].trim(), // é£Ÿæåç¨±
                amount: Number(match[2]), // æ•¸é‡
                unit: match[3] || "" // å–®ä½
            };
        }

        function mapRecipe(raw) {
            return {
                id: raw.id,
                name: raw.name,
                categoryKey: CATEGORY_MAP[raw.category],
                description: raw.shortDesc,
                image: {
                    src: raw.img,
                    alt: raw.name
                },
                ingredients: raw.ingredients.map(parseIngredient),
                steps: raw.steps.map((s, i) => ({
                    order: i + 1,
                    text: s
                })),
            };
        }

        const mappedRecipes = rawRecipesData.map(mapRecipe);

        createApp({
            data() {
                const saved = JSON.parse(localStorage.getItem("userState") || "{}");
                return {
                    searchText: "",
                    selectedCategory: null,
                    selectedRecipe: null,
                    portion: 1, // ä»½é‡å€æ•¸
                    recipes: mappedRecipes.map(r => {
                        const savedState = saved[r.id] || {};
                        return {
                            ...r,
                            favorite: savedState.favorite || false,
                            rating: savedState.rating || 0
                        }
                    }),
                    categoryLabel: {
                        cake: "è›‹ç³•",
                        cookie: "é¤…ä¹¾",
                        bread: "éºµåŒ…"
                    }
                };
            },
            computed: {
                filteredRecipes() {
                    return this.recipes.filter(r => {
                        const categoryMatch = !this.selectedCategory || r.categoryKey === this.selectedCategory;
                        const searchMatch = r.name.toLowerCase().includes(this.searchText.toLowerCase());
                        return categoryMatch && searchMatch;
                    });
                },
                categoryCounts() {
                    // è¨ˆç®—æ¯å€‹åˆ†é¡çš„é£Ÿè­œæ•¸é‡
                    const counts = {
                        all: this.recipes.length
                    };
                    this.recipes.forEach(r => {
                        const key = r.categoryKey;
                        counts[key] = (counts[key] || 0) + 1;
                    });
                    return counts;
                },
                categoryButtons() {
                    // å‹•æ…‹ç”Ÿæˆå¸¶æœ‰è¨ˆæ•¸çš„åˆ†é¡æŒ‰éˆ•æ•¸æ“š
                    return [{
                        label: "å…¨éƒ¨",
                        key: null,
                        count: this.recipes.length
                    }, {
                        label: "è›‹ç³•",
                        key: "cake",
                        count: this.categoryCounts.cake || 0
                    }, {
                        label: "é¤…ä¹¾",
                        key: "cookie",
                        count: this.categoryCounts.cookie || 0
                    }, {
                        label: "éºµåŒ…",
                        key: "bread",
                        count: this.categoryCounts.bread || 0
                    }];
                }
            },
            methods: {
                buttonClass(key) {
                    return this.selectedCategory === key ? "bg-purple-600 text-white shadow-md" : "bg-gray-200 text-gray-700 hover:bg-gray-300";
                },
                selectRecipe(r) {
                    this.selectedRecipe = r;
                    this.portion = 1; // é‡ç½®ä»½é‡
                },
                closeRecipe() {
                    this.selectedRecipe = null;
                },
                resetFilters() {
                    this.searchText = "";
                    this.selectedCategory = null;
                },
                adjustedIngredients(r) {
                    // è¨ˆç®—èª¿æ•´å¾Œçš„é£Ÿæä»½é‡
                    const p = this.portion;
                    return r.ingredients.map(i => {
                        if (i.amount) {
                            const adjustedAmount = (i.amount * p)
                            const formattedAmount = adjustedAmount % 1 !== 0 ? adjustedAmount.toFixed(1) : adjustedAmount;
                            return `${i.name} ${formattedAmount}${i.unit}`;
                        }
                        return i.name;
                    });
                },
                saveState() {
                    const state = {};
                    this.recipes.forEach(r => state[r.id] = {
                        favorite: r.favorite,
                        rating: r.rating
                    });
                    localStorage.setItem("userState", JSON.stringify(state));
                },
                toggleFavorite(r) {
                    r.favorite = !r.favorite;
                    this.saveState();
                },
                rate(r, n) {
                    r.rating = n;
                    this.saveState();
                },
                printRecipe(r) {
                    // ä½¿ç”¨ç•¶å‰èª¿æ•´å¾Œçš„ä»½é‡ä¾†ç”Ÿæˆåˆ—å°æ¸…å–®
                    const ingredientsList = this.adjustedIngredients(r).map(item => `<li>${item}</li>`).join('');
                    const stepsList = r.steps.map(s => `<li>${s.text}</li>`).join('');

                    const w = window.open("", "", "width=800,height=1000");
                    w.document.write(`<html>
                        <head>
                            <title>${r.name} - æ‰“å°</title>
                            <style>
                                body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
                                h1 { color: #5B21B6; border-bottom: 2px solid #E9D5FF; padding-bottom: 5px; }
                                h2 { color: #5B21B6; margin-top: 15px; }
                                ul, ol { margin-left: 20px; padding-left: 0; }
                            </style>
                        </head>
                        <body>
                            <h1>${r.name}</h1>
                            <p>${r.description}</p>
                            <h2>ææ–™ (ç•¶å‰ä»½é‡ï¼šx${this.portion})</h2>
                            <ul>${ingredientsList}</ul>
                            <h2>æ­¥é©Ÿ</h2>
                            <ol>${stepsList}</ol>
                        </body>
                    </html>`);
                    w.document.close();
                    w.print();
                    w.close();
                }
            }
        }).mount("#app");
    </script>
</body>

</html>

